<div class="discover-container main-content">
    <div class="discover-mode-selector">
        <button class="mode-btn" [class.active]="mode === 'waiting'" (click)="setMode('waiting')">
            <div class="mode-icon">⏳</div>
            <div class="mode-label">待评</div>
            <div class="mode-desc">随机探索未评分照片</div>
        </button>
        <button class="mode-btn" [class.active]="mode === 'all'" (click)="setMode('all')">
            <div class="mode-icon">🔍</div>
            <div class="mode-label">所有</div>
            <div class="mode-desc">浏览库中所有照片</div>
        </button>
        <button class="mode-btn" [class.active]="mode === 'top'" (click)="setMode('top')">
            <div class="mode-icon">⭐</div>
            <div class="mode-label">精选</div>
            <div class="mode-desc">按分数排名的佳作</div>
        </button>
    </div>

    <div class="discover-photos-grid">
        <div *ngFor="let photo of photos" class="discover-item" (click)="openViewer(photo.id)">
            <img [src]="photoService.getImageUrl(photo.filePath)" loading="lazy">
            <div class="discover-item-overlay">
                <div class="discover-item-score">分数: {{ photo.overallScore | number:'1.2-2' }}</div>
            </div>
        </div>
    </div>

    <div *ngIf="isLoading" class="loading-more">
        <div class="loading-spinner-small"></div>
        <span>加载更多...</span>
    </div>

    <div *ngIf="!hasMore && photos.length === 0" style="text-align: center; color: var(--text-secondary); width: 100%;">
        暂无照片
    </div>
</div>

<app-photo-viewer *ngIf="viewerOpen"
                  [startPhotoId]="initialPhotoId"
                  [photos]="photos"
                  (close)="closeViewer()">
</app-photo-viewer>
